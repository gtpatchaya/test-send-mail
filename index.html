<form id="contact">
  <input name="name" placeholder="Name" required />
  <input name="email" type="email" placeholder="Email" required />
  <input name="subject" placeholder="Subject" required />
  <textarea name="message" rows="5" placeholder="Message" required></textarea>
  <button>Send</button>
</form>
<div id="status"></div>

<script>
  const ENDPOINT = 'https://script.google.com/macros/s/AKfycbyy4HJFTUoJejtSPQihTDTHrJBw4Z6Nsdhtgn0BH-4WCnfnWJJLcbMOCUrg3brG12ZZ/exec'; // URL จาก Deploy

  function sendViaJSONP(params) {
    return new Promise((resolve, reject) => {
      const cb = 'cb_' + Math.random().toString(36).slice(2);
      const s = document.createElement('script');
      window[cb] = (resp) => {
        delete window[cb];
        s.remove();
        (resp && resp.ok) ? resolve(resp) : reject(resp);
      };
      s.onerror = () => {
        delete window[cb];
        s.remove();
        reject(new Error('Network error'));
      };
      const qs = new URLSearchParams({ ...params, callback: cb }).toString();
      s.src = `${ENDPOINT}?${qs}`;
      document.body.appendChild(s);
    });
  }

  const form = document.getElementById('contact');
  const statusEl = document.getElementById('status');

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    statusEl.textContent = 'Sending...';
    const f = e.target;
    const payload = {
      name: f.name.value.trim(),
      email: f.email.value.trim(),
      subject: f.subject.value.trim(),
      message: f.message.value.trim()
    };
    try {
      await sendViaJSONP(payload);
      statusEl.textContent = '✅ Sent!';
      f.reset();
    } catch (err) {
      statusEl.textContent = '❌ Send failed';
      console.error(err);
    }
  });
</script>