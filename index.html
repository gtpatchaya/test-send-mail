<form id="contact">
  <input name="name" placeholder="Name" required />
  <input name="email" type="email" placeholder="Email" required />
  <input name="subject" placeholder="Subject" required />
  <textarea name="message" rows="6" placeholder="Message" required></textarea>
  <button>Send</button>
</form>

<script>
  const ENDPOINT = 'https://script.google.com/macros/s/AKfycbwYaRzXdB78lqHQhTqCumsnn0tpYb6hBYtxtTQuS3RlEj2jayh9-Djz1XX4RfXZDpY/exec';

  document.getElementById('contact').addEventListener('submit', async (e) => {
    e.preventDefault();
    const f = e.target;
    const payload = {
      name: f.name.value,
      email: f.email.value,
      subject: f.subject.value,
      message: f.message.value
    };
    try {
      const res = await fetch(ENDPOINT, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      });
      // Apps Script มักตอบ 200 + JSON อ่านผลได้เลย
      alert('ส่งแล้ว ขอบคุณครับ!');
      f.reset();
    } catch (err) {
      alert('ส่งไม่สำเร็จ: ' + err.message);
    }
  });
</script>